# DASHBOARD MODIFICATION - PART 1/2

## DANS dashboard_daily.html

## 1. CHERCHE <div class="filters"> ET REMPLACE PAR:

```html
<div class="filters">
    <div class="filter-group">
        <label>Edge minimum:</label>
        <input type="number" id="minEdge" value="5" min="0" max="20" step="0.5">
        <span>%</span>
    </div>

    <div class="filter-group">
        <label>Confiance:</label>
        <select id="minConfidence">
            <option value="LOW">Toutes</option>
            <option value="MEDIUM" selected>Moyenne+</option>
            <option value="HIGH">Haute uniquement</option>
        </select>
    </div>
    
    <!-- NOUVEAU: Sélecteur jours -->
    <div class="filter-group">
        <label>Période:</label>
        <select id="daysToScan">
            <option value="1">Aujourd'hui</option>
            <option value="2" selected>2 jours</option>
        </select>
    </div>

    <button class="btn-scan" onclick="scanOpportunities()">
        Scanner les opportunités
    </button>

    <div style="margin-left: auto;">
        <small id="apiUsage" style="color: #666;">API: --/--</small>
    </div>
</div>
```

---

## 2. APRÈS <div id="statsBar"...> AJOUTE:

```html
<div id="dayTabs" class="day-tabs hidden"></div>
```

---

## 3. DANS LA SECTION <style>, AJOUTE:

```css
.day-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    background: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.day-tab {
    flex: 1;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    cursor: pointer;
    background: #f8f9fa;
    border: 2px solid transparent;
    transition: all 0.3s;
}

.day-tab:hover {
    background: #e9ecef;
}

.day-tab.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    font-weight: 700;
}

.day-tab-date {
    font-size: 1.2em;
    font-weight: 700;
    margin-bottom: 5px;
}

.day-tab-count {
    font-size: 0.9em;
    opacity: 0.8;
}
```

Continue avec PART 2 pour le JavaScript

# DASHBOARD MODIFICATION - PART 2/2 (JAVASCRIPT)

## 4. CHERCHE LA FONCTION scanOpportunities() EN JAVASCRIPT

## REMPLACE PAR:

```javascript
let currentData = null;  // AJOUTE CETTE VARIABLE GLOBALE

async function scanOpportunities() {
    const minEdge = document.getElementById('minEdge').value;
    const minConfidence = document.getElementById('minConfidence').value;
    const days = document.getElementById('daysToScan').value;  // NOUVEAU

    document.getElementById('loadingDiv').classList.remove('hidden');
    document.getElementById('statsBar').classList.add('hidden');
    document.getElementById('resultsDiv').classList.add('hidden');
    document.getElementById('dayTabs').classList.add('hidden');
    document.getElementById('emptyDiv').classList.add('hidden');
    document.getElementById('errorDiv').classList.add('hidden');

    try {
        const response = await fetch(
            `${API_URL}/api/daily-opportunities?min_edge=${minEdge}&min_confidence=${minConfidence}&days=${days}`
        );

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();

        if (data.status === 'SUCCESS') {
            displayResults(data);
        } else {
            displayError(data.message || 'Erreur');
        }
    } catch (error) {
        displayError(`Erreur: ${error.message}`);
    } finally {
        document.getElementById('loadingDiv').classList.add('hidden');
        loadAPIUsage();
    }
}
```

---

## 5. REMPLACE LA FONCTION displayResults():

```javascript
function displayResults(data) {
    currentData = data;  // STOCKE LES DONNÉES
    
    // Update stats
    document.getElementById('statsBar').classList.remove('hidden');
    document.getElementById('totalProps').textContent = data.total_props_available;
    document.getElementById('analyzedProps').textContent = data.total_analyzed;
    document.getElementById('foundOpps').textContent = data.opportunities_found;
    
    if (data.opportunities_found > 0) {
        const avgEdge = data.opportunities.reduce((sum, o) => 
            sum + o.line_analysis.edge, 0) / data.opportunities_found;
        document.getElementById('avgEdge').textContent = avgEdge.toFixed(1) + '%';
    } else {
        document.getElementById('avgEdge').textContent = '-';
    }

    const scanTime = new Date(data.scan_time);
    document.getElementById('scanTime').textContent = scanTime.toLocaleTimeString('fr-FR', {
        hour: '2-digit', minute: '2-digit'
    });

    if (data.opportunities_found === 0) {
        document.getElementById('emptyDiv').classList.remove('hidden');
        document.getElementById('emptyEdge').textContent = data.filters.min_edge;
        return;
    }

    // Crée onglets par jour
    const opportunitiesByDate = data.opportunities_by_date || {};
    const dates = Object.keys(opportunitiesByDate).sort();
    
    if (dates.length > 1) {
        const tabsDiv = document.getElementById('dayTabs');
        tabsDiv.innerHTML = '';
        
        dates.forEach((date, index) => {
            const count = opportunitiesByDate[date].length;
            const dateObj = new Date(date);
            const isToday = dateObj.toDateString() === new Date().toDateString();
            const isTomorrow = dateObj.toDateString() === new Date(Date.now() + 86400000).toDateString();
            
            let dayLabel = dateObj.toLocaleDateString('fr-FR', { 
                weekday: 'long', day: 'numeric', month: 'long' 
            });
            
            if (isToday) dayLabel = "Aujourd'hui";
            if (isTomorrow) dayLabel = "Demain";
            
            const tab = document.createElement('div');
            tab.className = `day-tab ${index === 0 ? 'active' : ''}`;
            tab.onclick = () => showDay(date);
            tab.innerHTML = `
                <div class="day-tab-date">${dayLabel}</div>
                <div class="day-tab-count">${count} opportunité(s)</div>
            `;
            tabsDiv.appendChild(tab);
        });
        
        tabsDiv.classList.remove('hidden');
    }
    
    if (dates.length > 0) {
        showDay(dates[0]);
    }
}
```

---

## 6. AJOUTE CETTE NOUVELLE FONCTION:

```javascript
function showDay(date) {
    if (!currentData) return;
    
    // Update active tab
    document.querySelectorAll('.day-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    if (event && event.target) {
        event.target.closest('.day-tab')?.classList.add('active');
    }
    
    // Affiche opportunités du jour
    const opportunities = currentData.opportunities_by_date[date] || [];
    
    const resultsDiv = document.getElementById('resultsDiv');
    resultsDiv.innerHTML = opportunities.map(opp => createOpportunityCard(opp)).join('');
    resultsDiv.classList.remove('hidden');
}
```

---

## 7. DANS createOpportunityCard(), AJOUTE APRÈS <div class="opp-card ${recClass}">:

```javascript
    // Info du match
    const gameInfo = opp.game_info || {};
    const gameDate = gameInfo.date ? new Date(gameInfo.date).toLocaleDateString('fr-FR') : '';
    const gameTime = gameInfo.time ? new Date(gameInfo.time).toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'}) : '';
    const matchup = gameInfo.away_team && gameInfo.home_team ? 
        `${gameInfo.away_team} @ ${gameInfo.home_team}` : '';

    return `
        <div class="opp-card ${recClass}">
            ${gameDate || gameTime ? `
                <div style="background: #e0f2fe; padding: 8px 12px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em;">
                    <strong>Match:</strong> ${matchup}<br>
                    <strong>Date:</strong> ${gameDate} à ${gameTime}
                </div>
            ` : ''}
            
            <!-- Reste du code inchangé -->
```

---

## C'EST TOUT! 

Push:
```bash
git add .
git commit -m "feat: support 2 jours"
git push
```
